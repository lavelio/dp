"use strict";(self.webpackChunkoffice_addin_taskpane_react=self.webpackChunkoffice_addin_taskpane_react||[]).push([[926],{86863:function(e,t,n){var a=n(96540),r=n(5338),i=n(44541),l=n(29105),o=n(63171),s=n(52766),c=n(83128),d=n(96668),m=n(74324),u=n(86702),p=n(26117),g=n(25892),f=n(11439),h=n(65127),x=n(68764),v=n(40678),y=n(1419),b=n(86366),E=n(48352),w=n(10900),S=n(24938),A=n(27037),N=n(9265),C=n(27395),k=n(89674);const O=(0,i.n)({dialog:{marginTop:"10px",marginRight:"10px",marginLeft:"10px"},dialog_apply:{backgroundColor:"red"}});var B=e=>{const t=O();return a.createElement(g.l,{modalType:e.type,defaultOpen:!0,onOpenChange:()=>{e.onResultDialog("cancel")}},a.createElement(f.E,{className:t.dialog},a.createElement(S.R,null,a.createElement(A.L,null,e.title),a.createElement(N.C,null,(0,w.Ay)(e.content)),a.createElement(C.i,null,a.createElement(k.z,{disableButtonEnhancement:!0},a.createElement(E.$,{appearance:"secondary",autoFocus:!0},e.closeName)),e.showPrimary&&a.createElement(E.$,{appearance:"primary",className:t.dialog_apply,onClick:()=>{e.onResultDialog("ok")}},"Löschen")))))},I=n(64583).Promise;const z=(e,t,n,a,r,i,l,o,s,c,d,m="email",u=!0)=>{return p=void 0,g=null,f=function*(){try{const e="email"===m?"/outlook/generate-email":"/outlook/generate-content",c={user_input:i,user_email:l,messages:[{subject:n,sender:a,body:r,recipients:o,cc:s}]};d&&d.length>0&&(c.documents=d),"content"===m&&(c.include_email=u);const p="https://fg.server.lavel.io"+e,g=yield fetch(p,{method:"POST",headers:{"Content-Type":"application/json",Authorization:t},body:JSON.stringify(c)});return yield g.json()}catch(e){throw e}},new I(((e,t)=>{var n=e=>{try{r(f.next(e))}catch(e){t(e)}},a=e=>{try{r(f.throw(e))}catch(e){t(e)}},r=t=>t.done?e(t.value):I.resolve(t.value).then(n,a);r((f=f.apply(p,g)).next())}));var p,g,f};var T=n(64583).Promise,D=(e,t,n)=>new T(((a,r)=>{var i=e=>{try{o(n.next(e))}catch(e){r(e)}},l=e=>{try{o(n.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):T.resolve(e.value).then(i,l);o((n=n.apply(e,t)).next())}));function j(e){return D(this,null,(function*(){var t;try{null==(t=Office.context.mailbox.item)||t.body.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Text},(e=>{if(e.status===Office.AsyncResultStatus.Failed)throw e.error.message}))}catch(e){}}))}function _(e){return D(this,null,(function*(){Office.context.mailbox.item.subject.getAsync((t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const n=t.value;Office.context.mailbox.item.from.getAsync((t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const a=t.value.emailAddress,r=a;Office.context.mailbox.item.to.getAsync((t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const i=t.value.map((e=>e.emailAddress));Office.context.mailbox.item.cc.getAsync((t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const l=t.value.map((e=>e.emailAddress));Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text,(t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const o=t.value;e({subject:n,sender:a,body:o,user_email:r,recipients:i,cc:l})}))}))}))}))}))}))}var P=n(79804),R=n(80964),F=n(43954),$=n(80827),K=n(65892),L=n(94796),M=n(35404),W=n(48697),V=n(64583).Promise,Z=Object.defineProperty,H=Object.defineProperties,J=Object.getOwnPropertyDescriptors,q=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,Q=(e,t,n)=>t in e?Z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,X=(e,t)=>{for(var n in t||(t={}))G.call(t,n)&&Q(e,n,t[n]);if(q)for(var n of q(t))U.call(t,n)&&Q(e,n,t[n]);return e},Y=(e,t)=>H(e,J(t)),ee=(e,t,n)=>new V(((a,r)=>{var i=e=>{try{o(n.next(e))}catch(e){r(e)}},l=e=>{try{o(n.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):V.resolve(e.value).then(i,l);o((n=n.apply(e,t)).next())}));const te="fg-chat-ocr",ne=(0,i.n)({root:{flexDirection:"column",display:"flex",padding:"0 10px",width:"100%",boxSizing:"border-box"},answer_dialog:{flexDirection:"column",display:"flex",width:"100%",boxSizing:"border-box",maxWidth:"100%",overflow:"hidden"},dialog_field:{fontWeight:600,marginBottom:"15px"},button_send:{width:"100%",marginBottom:"10px"},spinner:{width:"75%"},customLoadingOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.8)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999},toggleContainer:{display:"flex",alignItems:"center",justifyContent:"flex-start",marginBottom:"15px",padding:"0",width:"100%",boxSizing:"border-box",maxWidth:"100%",overflow:"hidden"},toggleGroupContainer:{display:"flex",width:"100%",boxSizing:"border-box",overflow:"hidden"},toggleButton:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px 15px",border:"1px solid #e0e0e0",backgroundColor:"#f5f5f5",cursor:"pointer",flex:1,transition:"all 0.2s ease",fontWeight:400,fontSize:"14px",userSelect:"none"},toggleButtonLeft:{borderRadius:"4px 0 0 4px",borderRight:"none"},toggleButtonRight:{borderRadius:"0 4px 4px 0"},toggleButtonActive:{backgroundColor:"#006d5c",color:"white",fontWeight:600},toggleButtonInactive:{opacity:.9},toggleIcon:{marginRight:"8px",verticalAlign:"middle"},checkboxContainer:{marginTop:"5px",marginBottom:"15px",display:"flex",alignItems:"center"},loadingText:{marginTop:"10px",fontSize:"14px",fontWeight:600},pencil:{marginLeft:"2px",marginRight:"4px"},dropZone:{border:"2px dashed #ccc",borderRadius:"4px",padding:"20px",textAlign:"center",marginBottom:"15px",cursor:"pointer",transition:"all 0.3s ease"},dropZoneActive:{border:"2px dashed #0078d4",backgroundColor:"rgba(0, 120, 212, 0.05)"},dropZoneSuccess:{border:"2px dashed #107c10",backgroundColor:"rgba(16, 124, 16, 0.05)"},filePreview:{display:"flex",alignItems:"center",padding:"8px 12px",backgroundColor:"#f3f2f1",borderRadius:"4px",marginBottom:"15px"},fileIcon:{marginRight:"8px",color:"#0078d4"},fileName:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},removeButton:{cursor:"pointer",color:"#605e5c","&:hover":{color:"#d13438"}},copyButton:{cursor:"pointer",color:"#605e5c",marginRight:"8px","&:hover":{color:"#0078d4"}},divider:{margin:"15px 0"},fileUploadInfo:{marginBottom:"10px",fontSize:"12px",color:"#605e5c"},ocrCompletedMessage:{color:"green",display:"block",marginTop:"5px"},checkIcon:{verticalAlign:"middle",marginRight:"5px"},hiddenInput:{display:"none"}});var ae=()=>{const e=ne(),[t,n]=a.useState({show:!1,text:""}),[r,i]=a.useState(!1),[o,s]=a.useState(!1),[w,S]=a.useState({current:"",state:"none"}),[A,N]=a.useState({}),[C,k]=a.useState(""),[O,I]=a.useState(!1),[T,D]=a.useState([]),[V,Z]=a.useState(!1),[H,J]=a.useState(!1),[q,G]=a.useState(!1),[U,Q]=a.useState([]),[ae,re]=a.useState("email"),[ie,le]=a.useState(!0),oe=a.useRef(null),{dispatchToast:se}=(0,c.J)(),ce="Eingeben..";a.useEffect((()=>{ee(void 0,null,(function*(){var e=localStorage.getItem("answer");e&&""!=e||(e=ce),S({current:e,state:"none"}),k(""),N({}),D([]),G(!1),Q([])}))}),[]);const de=(e,t)=>{const n=e.map((e=>t[e.name]||"")).filter((e=>""!==e.trim())).join("\n\n");k(n)},me=e=>ee(void 0,null,(function*(){try{const t=localStorage.getItem("apiKey")||"";if(""===t)return n({show:!0,text:"API-Schlüssel nicht angegeben"}),void J(!1);const r=e.map((e=>({filename:e,bucket:te}))),i=yield fetch("https://fg.server.lavel.io/outlook/ocr-detect",{method:"POST",headers:{"Content-Type":"application/json",Authorization:t},body:JSON.stringify({files:r})}),l=yield i.json();if(!i.ok)throw new Error(l.detail||"OCR processing failed");if(l.documents&&l.documents.length>0){const t=X({},A);l.documents.forEach(((n,a)=>{var r;if(a<e.length&&n.text){const e=(null==(r=T[a])?void 0:r.name)||`Document ${a+1}`;t[e]=n.text}})),N(t);const n=T.map((e=>t[e.name]||"")).filter((e=>""!==e.trim())).join("\n\n");k(n)}J(!1),G(!0),se(a.createElement(d.y,null,a.createElement(m.S,{media:a.createElement(P.A,{color:"green"})},"OCR erfolgreich abgeschlossen")),{position:"top",timeout:5e3})}catch(e){n({show:!0,text:`OCR-Fehler: ${e.message}`}),J(!1)}}));a.useEffect((()=>{T.length>0&&!V&&!H&&!q&&ee(void 0,null,(function*(){if(0!==T.length){Z(!0),J(!0);try{const e=[],t=[],n=[];for(const a of T){const r=yield fetch("https://fg.server.lavel.io/generate_presigned_upload_url",{method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("apiKey")||""},body:JSON.stringify({filename:a.name,content_type:a.type,bucket_name:te})});if(!r.ok)throw new Error(`Failed to get presigned URL: ${r.statusText}`);const i=yield r.json(),l=yield fetch(i.url,{method:"PUT",headers:{"Content-Type":a.type},body:a});if(!l.ok)throw new Error(`Failed to upload ${a.name}: ${l.statusText}`);e.push(i.filename),t.push(i.uuid),n.push(i.filetype)}Q(e),Z(!1),yield me(t.map(((e,t)=>`${e}${n[t]}`)))}catch(e){n({show:!0,text:`Fehler beim Hochladen: ${e.message}`}),Z(!1),J(!1)}}}))}),[T,V,H,q]);const ue=e=>{re(e)};return a.createElement("div",{className:e.root,role:"tabpanel","aria-labelledby":"Settings"},a.createElement(u.l,null),o&&a.createElement("div",{className:e.customLoadingOverlay},a.createElement(p.y,{size:"large"}),a.createElement("div",{className:e.loadingText},"Antwort wird generiert...")),(r||V||H)&&a.createElement(g.l,{defaultOpen:!0},a.createElement(f.E,{className:e.spinner},a.createElement(p.y,{autoFocus:!0,labelPosition:"after",label:V?"Dateien werden hochgeladen...":H?"OCR-Verarbeitung läuft...":"Wird geladen..."}))),t.show&&a.createElement(B,{type:"alert",title:"Fehler",content:t.text,closeName:"OK",showPrimary:!1,onResultDialog:()=>{i(!1),n(Y(X({},t),{show:!1}))}}),a.createElement("div",{className:e.answer_dialog},a.createElement("div",{style:{display:"flex",alignItems:"center",margin:"10px 0"}},a.createElement(R.A,{size:18,style:{marginRight:"4px"}}),a.createElement("span",{style:{fontWeight:500,fontSize:"14px"}},"Modus")),a.createElement("div",{style:{display:"flex",width:"100%",marginBottom:"15px"}},a.createElement(h.m,{content:"Erstellt eine formelle E-Mail-Antwort mit Anrede und Grußformel basierend auf Ihrem Input und den vorliegenden Informationen.",relationship:"label"},a.createElement("div",{className:`${e.toggleButton} ${e.toggleButtonLeft} ${"email"===ae?e.toggleButtonActive:e.toggleButtonInactive}`,onClick:()=>ue("email")},a.createElement(F.A,{size:18,color:"email"===ae?"white":"#006d5c",className:e.toggleIcon}),"E-Mail Antwort")),a.createElement(h.m,{content:"Erzeugt flexiblen Text nach Ihren Vorgaben - mit oder ohne Berücksichtigung des E-Mail-Kontexts.",relationship:"label"},a.createElement("div",{className:`${e.toggleButton} ${e.toggleButtonRight} ${"content"===ae?e.toggleButtonActive:e.toggleButtonInactive}`,onClick:()=>ue("content")},a.createElement($.A,{size:18,color:"content"===ae?"white":"#006d5c",className:e.toggleIcon}),"Freier Text"))),"content"===ae&&a.createElement("div",{className:e.checkboxContainer},a.createElement(x.S,{label:"E-Mail-Informationen einbeziehen",checked:ie,onChange:(e,t)=>{le(t.checked)}})),a.createElement(v.D,{className:e.dialog_field,label:a.createElement(a.Fragment,null,a.createElement(K.A,{size:18,className:e.pencil}),"email"===ae?"Nutzer Input":"Nutzer Input (+ Anweisungen an KI)"),validationState:w.state,validationMessage:"Kurze Antwort eingeben",required:!0},a.createElement(y.T,{value:w.current,rows:10,placeholder:"email"===ae?"Kurzen Text eingeben..":"Kurzen Text und Anweisungen eingeben..",size:"large",resize:"vertical",onChange:e=>{const t=e.target.value;S(Y(X({},w),{current:t})),k(t)},lang:"de"})),a.createElement(l.c,{className:e.divider}),a.createElement(b.E,{className:e.fileUploadInfo},"Laden Sie bis zu 5 PDF-Dateien hoch, um Text zu extrahieren und in die Anfrage einzubeziehen"),a.createElement("div",{ref:oe,className:`${e.dropZone} ${O?e.dropZoneActive:""} ${q?e.dropZoneSuccess:""}`,onDragOver:e=>{e.preventDefault(),I(!0)},onDragLeave:e=>{e.preventDefault(),I(!1)},onDrop:e=>{if(e.preventDefault(),I(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0){const t=Array.from(e.dataTransfer.files),a=t.filter((e=>"application/pdf"===e.type)),r=t.length-a.length;if(r>0&&n({show:!0,text:`${r} Datei(en) wurden ignoriert. Nur PDF-Dateien werden unterstützt.`}),a.length>0){const e=[...T,...a].slice(0,5);D(e),G(!1),T.length+a.length>5&&n({show:!0,text:"Maximal 5 Dateien können hochgeladen werden."})}}},onClick:()=>{const e=document.getElementById("file-input");e&&e.click()}},a.createElement(L.A,{size:24}),a.createElement("p",null,"PDF-Dateien hierher ziehen oder klicken zum Auswählen (",T.length,"/5)",q&&T.length>0&&a.createElement("span",{className:e.ocrCompletedMessage},a.createElement(P.A,{size:16,className:e.checkIcon}),"OCR abgeschlossen")),a.createElement("input",{id:"file-input",type:"file",accept:"application/pdf",className:e.hiddenInput,multiple:!0,onChange:e=>{if(e.target.files&&e.target.files.length>0){const t=Array.from(e.target.files),a=t.filter((e=>"application/pdf"===e.type)),r=t.length-a.length;if(r>0&&n({show:!0,text:`${r} Datei(en) wurden ignoriert. Nur PDF-Dateien werden unterstützt.`}),a.length>0){const e=[...T,...a].slice(0,5);D(e),G(!1),T.length+a.length>5&&n({show:!0,text:"Maximal 5 Dateien können hochgeladen werden."})}}},"aria-label":"PDF-Datei auswählen"})),T.length>0&&a.createElement("div",{style:{marginBottom:"15px"}},T.map(((t,r)=>a.createElement("div",{key:r,className:e.filePreview},a.createElement($.A,{size:20,className:e.fileIcon}),a.createElement("span",{className:e.fileName},t.name),a.createElement(M.A,{size:18,className:e.copyButton,onClick:()=>(e=>{const t=T[e],r=t?t.name:"",i=r&&A[r]?A[r]:"";if(s(!1),i&&""!==i.trim())try{const e=document.createElement("textarea");e.value=i,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),se(a.createElement(d.y,null,a.createElement(m.S,{media:a.createElement(P.A,{color:"green"})},"Text in die Zwischenablage kopiert")),{position:"top",timeout:3e3})}catch(e){n({show:!0,text:`Fehler beim Kopieren des Textes: ${e.message}`})}else n({show:!0,text:"Kein OCR-Text für dieses Dokument verfügbar"})})(r),"aria-label":"Copy OCR text"}),a.createElement(W.A,{size:18,className:e.removeButton,onClick:()=>(e=>{const t=T[e],n=[...T];if(n.splice(e,1),D(n),t){const e=X({},A);delete e[t.name],N(e),de(n,e)}0===n.length&&(G(!1),Q([]),k(""),N({}))})(r),"aria-label":"Remove file"}))))),a.createElement(E.$,{className:e.button_send,appearance:"primary",onClick:()=>{if((()=>{var e;let t=!0;var n=null!=(e=w.current)?e:"";return" "==n&&(n=ce,localStorage.setItem("answer",n)),""==(n=n.trim())?(S({current:n,state:"error"}),t=!1):S({current:n,state:"none"}),t})()){s(!1),localStorage.setItem("answer",w.current),k(w.current);var e=localStorage.getItem("apiKey");""!=e?T.length>0&&!q?n({show:!0,text:"Bitte warten Sie, bis die OCR-Verarbeitung der PDF-Dateien abgeschlossen ist, bevor Sie eine Antwort generieren."}):_((t=>{i(!0),s(!0);var a=w.current;const r=[];if(T.length>0)for(const e of T)A[e.name]&&""!==A[e.name].trim()&&r.push({filename:e.name,text:A[e.name]});z(0,e,t.subject,t.sender,t.body,a,t.user_email,t.recipients,t.cc,0,r,ae,ie).then((e=>ee(void 0,null,(function*(){if(i(!1),s(!1),"success"!=e.status){let t="Ein Fehler ist aufgetreten.";return e.detail&&(t="string"==typeof e.detail?e.detail:Array.isArray(e.detail)?e.detail.map((e=>"string"==typeof e?e:e.msg?e.msg:JSON.stringify(e))).join("\n"):JSON.stringify(e.detail)),void n({show:!0,text:t})}j("email"===ae?e.email_text:e.content_text)})))).catch((e=>{i(!1),s(!1),n({show:!0,text:`Anfragefehler: ${e}`})}))})):n({show:!0,text:"API-Schlüssel nicht angegeben"})}}},"email"===ae?"Antwort generieren":"Text generieren")))},re=n(14852),ie=n(64583).Promise,le=Object.defineProperty,oe=Object.defineProperties,se=Object.getOwnPropertyDescriptors,ce=Object.getOwnPropertySymbols,de=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable,ue=(e,t,n)=>t in e?le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pe=(e,t)=>{for(var n in t||(t={}))de.call(t,n)&&ue(e,n,t[n]);if(ce)for(var n of ce(t))me.call(t,n)&&ue(e,n,t[n]);return e},ge=(e,t)=>oe(e,se(t));const fe=(0,i.n)({root:{flexDirection:"column",display:"flex",paddingLeft:"10px",paddingRight:"10px"},saving_dialog:{flexDirection:"column",display:"flex"},dialog_field:{fontWeight:600,marginBottom:"15px"},dialog_add:{width:"100%",marginBottom:"10px"}});var he=()=>{const e=fe(),[t,n]=a.useState({show:!1,text:""}),[r,i]=a.useState({current:"",state:"none"});a.useEffect((()=>{var e,t,n;e=void 0,t=null,n=function*(){var e=localStorage.getItem("apiKey");i({current:e,state:"none"})},new ie(((a,r)=>{var i=e=>{try{o(n.next(e))}catch(e){r(e)}},l=e=>{try{o(n.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):ie.resolve(e.value).then(i,l);o((n=n.apply(e,t)).next())}))}),[]);return a.createElement("div",{className:e.root,role:"tabpanel","aria-labelledby":"Settings"},t.show&&a.createElement(B,{type:"modal",title:"Info",content:t.text,closeName:"OK",showPrimary:!1,onResultDialog:()=>{n(ge(pe({},t),{show:!1}))}}),a.createElement("div",{className:e.saving_dialog},a.createElement(v.D,{className:e.dialog_field,label:"API-Schlüsselwert",validationState:r.state,validationMessage:"Kopieren Sie Ihren API-Schlüsselwert und fügen Sie ihn ein",required:!0},a.createElement(re.p,{value:r.current,placeholder:"z.b. outlookapi47eda17f38081e...",onChange:e=>{i(ge(pe({},r),{current:e.target.value}))}})),a.createElement(E.$,{className:e.dialog_add,appearance:"primary",onClick:()=>{var e;e=r.current.trim(),i(ge(pe({},r),{current:e,state:"none"})),localStorage.setItem("apiKey",r.current),n({show:!0,text:"Änderungen gespeichert"})}},"Speichern")))},xe=n(18297),ve=n(75399),ye=n(73885),be=n(33879),Ee=n(48635);const we=(0,i.n)({root:{flexDirection:"column",display:"flex",paddingLeft:"10px",paddingRight:"10px"},formContainer:{display:"flex",flexDirection:"column",gap:"15px"},button:{width:"100%",marginBottom:"10px"},spinner:{width:"75%"},customLoadingOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.8)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999},loadingText:{marginTop:"10px",fontSize:"14px",fontWeight:600},divider:{margin:"15px 0"},stepContainer:{marginBottom:"20px"},stepHeader:{display:"flex",alignItems:"center",marginBottom:"10px"},stepNumber:{display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#0078d4",color:"white",marginRight:"10px",fontSize:"14px",fontWeight:"bold"},stepTitle:{fontWeight:"bold",fontSize:"16px"},suggestionCard:{marginBottom:"15px",border:"1px solid #edebe9",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},cardHeader:{paddingBottom:"8px"},cardContent:{padding:"0 16px 16px 16px"},fieldGroup:{marginBottom:"12px"},fieldLabel:{fontWeight:"600",marginBottom:"4px",fontSize:"12px",color:"#605e5c"},fieldValue:{fontSize:"14px",padding:"8px",backgroundColor:"#f3f2f1",borderRadius:"4px"},nextStepButton:{marginTop:"10px"},assignedUserField:{marginTop:"15px"}});var Se=()=>{const e=we(),{dispatchToast:t}=(0,c.J)(),[n,r]=a.useState({show:!1,text:""}),[i,o]=a.useState(!1),[s,h]=a.useState(!1),[x,y]=a.useState(1),[w,S]=a.useState(""),[A,N]=a.useState(""),[C,k]=a.useState(""),[O,I]=a.useState([]),[z,T]=a.useState(""),[D,j]=a.useState(""),[R,F]=a.useState(""),[$,K]=a.useState("");a.useEffect((()=>{(()=>{try{o(!0),_((e=>{if(!e)return r({show:!0,text:"Keine E-Mail ausgewählt. Bitte wählen Sie eine E-Mail aus, um fortzufahren."}),void o(!1);const t=localStorage.getItem("apiKey");if(!t)return r({show:!0,text:"Kein API-Schlüssel gefunden. Bitte geben Sie einen API-Schlüssel in den Einstellungen ein."}),void o(!1);const n={messages:[{subject:e.subject||"",body:e.body||"",sender:e.sender||"",recipients:e.recipients||[],cc:e.cc||[],thread_body:e.body||"",raw_content:null}]};fetch("https://fg.server.lavel.io/outlook/combined-activity-data",{method:"POST",headers:{"Content-Type":"application/json",Authorization:t},body:JSON.stringify(n)}).then((e=>e.ok?e.json():e.json().then((e=>{throw new Error(e.detail||"Fehler beim Abrufen der Aktivitätsdaten")})))).then((t=>{S(t.suggested_title||""),N(t.category||""),k(t.folder_id||""),I(t.categories||[]),T(t.suggested_title||""),j(t.category||""),K(t.folder_id?`${t.folder_id}`:"");const n=localStorage.getItem("userEmail")||e.user_email||"";F(n),o(!1)})).catch((e=>{r({show:!0,text:`Fehler beim Abrufen der Vorschläge: ${e.message}`}),o(!1)}))}))}catch(e){r({show:!0,text:`Fehler: ${e.message}`}),o(!1)}})()}),[]);return a.createElement("div",{className:e.root},i&&a.createElement("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px"}},a.createElement(p.y,{className:e.spinner,label:"Lade Vorschläge..."})),s&&a.createElement("div",{className:e.customLoadingOverlay},a.createElement(p.y,{size:"large"}),a.createElement("div",{className:e.loadingText},"Aktivität wird erstellt...")),!i&&a.createElement("div",{className:e.formContainer},1===x&&a.createElement("div",{className:e.stepContainer},a.createElement("div",{className:e.stepHeader},a.createElement("div",{className:e.stepNumber},"1"),a.createElement("div",{className:e.stepTitle},"Aktivitätsvorschlag prüfen")),a.createElement(b.E,null,'Basierend auf der ausgewählten E-Mail wurde ein Aktivitätsvorschlag erstellt. Überprüfen Sie die Informationen und klicken Sie auf "Weiter", um fortzufahren.'),a.createElement(l.c,{className:e.divider}),a.createElement(xe.Z,{className:e.suggestionCard},a.createElement(ve.a,{className:e.cardHeader,header:a.createElement(b.E,{weight:"semibold"},"Vorgeschlagene Aktivität")}),a.createElement("div",{className:e.cardContent},a.createElement("div",{className:e.fieldGroup},a.createElement("div",{className:e.fieldLabel},"Titel"),a.createElement("div",{className:e.fieldValue},w)),a.createElement("div",{className:e.fieldGroup},a.createElement("div",{className:e.fieldLabel},"Kategorie"),a.createElement("div",{className:e.fieldValue},A)),a.createElement("div",{className:e.fieldGroup},a.createElement("div",{className:e.fieldLabel},"Ordner ID"),a.createElement("div",{className:e.fieldValue},C)))),a.createElement(E.$,{appearance:"primary",className:e.nextStepButton,onClick:()=>{y(2)},icon:a.createElement(Ee.A,null)},"Weiter zur Bearbeitung")),2===x&&a.createElement("div",{className:e.stepContainer},a.createElement("div",{className:e.stepHeader},a.createElement("div",{className:e.stepNumber},"2"),a.createElement("div",{className:e.stepTitle},"Aktivität bearbeiten und erstellen")),a.createElement(b.E,null,'Bearbeiten Sie die Aktivitätsinformationen nach Bedarf und klicken Sie auf "Aktivität erstellen", um die Aktivität zu erstellen.'),a.createElement(l.c,{className:e.divider}),a.createElement(v.D,{label:"Titel",required:!0},a.createElement(re.p,{value:z,onChange:e=>T(e.target.value),placeholder:"Aktivitätstitel"})),a.createElement(v.D,{label:"Kategorie",required:!0},a.createElement(ye.m,{value:D,onOptionSelect:(e,t)=>j(t.optionValue||""),placeholder:"Kategorie auswählen"},O.map((e=>a.createElement(be.c,{key:e,value:e},e))))),a.createElement(v.D,{label:"Ordnerpfad",required:!0},a.createElement(re.p,{value:$,onChange:e=>K(e.target.value),placeholder:"z.B. 301 Projektname"})),a.createElement(v.D,{label:"Zugewiesener Benutzer",required:!0,className:e.assignedUserField},a.createElement(re.p,{value:R,onChange:e=>F(e.target.value),placeholder:"E-Mail-Adresse"})),a.createElement(l.c,{className:e.divider}),a.createElement("div",{style:{display:"flex",gap:"10px"}},a.createElement(E.$,{appearance:"secondary",onClick:()=>{y(1)}},"Zurück"),a.createElement(E.$,{appearance:"primary",onClick:()=>{try{h(!0),_((e=>{if(!e)return r({show:!0,text:"Keine E-Mail ausgewählt. Bitte wählen Sie eine E-Mail aus, um fortzufahren."}),void h(!1);const n=localStorage.getItem("apiKey");if(!n)return r({show:!0,text:"Kein API-Schlüssel gefunden. Bitte geben Sie einen API-Schlüssel in den Einstellungen ein."}),void h(!1);if(!z.trim())return r({show:!0,text:"Bitte geben Sie einen Titel ein."}),void h(!1);if(!D.trim())return r({show:!0,text:"Bitte wählen Sie eine Kategorie aus."}),void h(!1);if(!R.trim())return r({show:!0,text:"Bitte geben Sie einen zugewiesenen Benutzer ein."}),void h(!1);if(!$.trim())return r({show:!0,text:"Bitte geben Sie einen Ordnerpfad ein."}),void h(!1);const i={title:z,category:D,assigned_user:R,messages:[{subject:e.subject||"",body:e.body||"",sender:e.sender||"",recipients:e.recipients||[],cc:e.cc||[],thread_body:e.body||""}],folder_path:$,shouldCreateActivity:!0};fetch("https://fg.server.lavel.io/outlook/create-activity",{method:"POST",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify(i)}).then((e=>e.ok?e.json():e.json().then((e=>{throw new Error(e.detail||"Fehler beim Erstellen der Aktivität")})))).then((e=>{t(a.createElement(d.y,null,a.createElement(m.S,{media:a.createElement(P.A,{color:"green"})},"Aktivität erfolgreich erstellt")),{position:"top",timeout:3e3}),y(1),S(""),N(""),k(""),T(""),j(""),F(""),K(""),h(!1)})).catch((e=>{r({show:!0,text:`Fehler beim Erstellen der Aktivität: ${e.message}`}),h(!1)}))}))}catch(e){r({show:!0,text:`Fehler: ${e.message}`}),h(!1)}}},"Aktivität erstellen")))),n.show&&a.createElement(g.l,{modalType:"alert",open:n.show},a.createElement(f.E,null,a.createElement(B,{title:"Hinweis",message:n.text,onClose:()=>r({show:!1,text:""})}))),a.createElement(u.l,null))};const Ae=(0,i.n)({root:{alignItems:"flex-start",display:"flex",flexDirection:"column",justifyContent:"flex-start",paddingTop:"10px",paddingLeft:"1px",paddingRight:"1px"},tab_menu:{paddingBottom:"20px"},tab_cont:{width:"100%"}}),Ne=()=>{const e=Ae();var t=localStorage.getItem("apiKey");const[n,r]=a.useState(""==t?"settings":"answer");return a.createElement("div",{className:e.root},a.createElement(o.w,{className:e.tab_menu,selectedValue:n,onTabSelect:(e,t)=>{r(t.value)}},a.createElement(s.o,{id:"Answer",value:"answer"},"Antwort"),a.createElement(s.o,{id:"Settings",value:"settings"},"Einstellungen")),a.createElement("div",{className:e.tab_cont},"answer"===n&&a.createElement(ae,null),"activity"===n&&a.createElement(Se,null),"settings"===n&&a.createElement(he,null)))};const Ce=(0,i.n)({root:{minHeight:"100vh",maxWidth:"370px"},divider:{marginTop:"10px"}});var ke=()=>{const e=Ce();return a.createElement("div",{className:e.root},a.createElement(Ne,null),a.createElement(l.c,{className:e.divider,inset:!0}))},Oe=n(37786),Be=n(66107),Ie=Object.defineProperty,ze=Object.getOwnPropertySymbols,Te=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable,je=(e,t,n)=>t in e?Ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const _e=((e,t)=>{for(var n in t||(t={}))Te.call(t,n)&&je(e,n,t[n]);if(ze)for(var n of ze(t))De.call(t,n)&&je(e,n,t[n]);return e})({},(0,Oe.a)({10:"#010101",20:"#010202",30:"#010403",40:"#0D1C17",50:"#0F2F25",60:"#0E3D30",70:"#094B3A",80:"#005B46",90:"#216753",100:"#377461",110:"#4B816F",120:"#5F8E7D",130:"#729B8C",140:"#85A99C",150:"#98B7AB",160:"#ACC4BB"})),Pe=document.getElementById("container"),Re=Pe?(0,r.H)(Pe):void 0;Office.onReady((()=>{null==Re||Re.render(a.createElement(Be.q,{theme:_e},a.createElement(ke,null)))}))},39046:function(){}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[96],(function(){return t(86863),t(39046)}));e.O()}]);
//# sourceMappingURL=taskpane.js.map