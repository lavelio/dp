"use strict";(self.webpackChunkoffice_addin_taskpane_react=self.webpackChunkoffice_addin_taskpane_react||[]).push([[926],{88078:function(e,t,a){var n=a(96540),r=a(5338),l=a(44541),o=a(29105),i=a(63171),c=a(97156),s=a(18819),u=a(31759),m=a(68987),d=a(68978),p=a(1419),f=a(48352),g=a(10900),y=a(24938),v=a(27037),h=a(9265),b=a(27395),x=a(69563);const w=(0,l.n)({dialog:{marginTop:"10px",marginRight:"10px",marginLeft:"10px"},dialog_apply:{backgroundColor:"red"}});var E=e=>{const t=w();return n.createElement(s.l,{modalType:e.type,defaultOpen:!0,onOpenChange:()=>{e.onResultDialog("cancel")}},n.createElement(u.E,{className:t.dialog},n.createElement(y.R,null,n.createElement(v.L,null,e.title),n.createElement(h.C,null,(0,g.Ay)(e.content)),n.createElement(b.i,null,n.createElement(x.z,{disableButtonEnhancement:!0},n.createElement(f.$,{appearance:"secondary",autoFocus:!0},e.closeName)),e.showPrimary&&n.createElement(f.$,{appearance:"primary",className:t.dialog_apply,onClick:()=>{e.onResultDialog("ok")}},"Löschen")))))},O=a(64583).Promise;function S(e,t,a,n,r,l,o){return i=this,c=arguments,s=function*(e,t,a,n,r,l,o,i=[],c=[]){var s="https://fg.server.lavel.io"+e;const u={messages:[{subject:a,body:r,sender:n,recipients:i,cc:c,thread_body:r,raw_content:null}],user_input:l,target_language:"german",user_email:o};var m={method:"POST",headers:{"Content-Type":"application/json",authorization:t},body:JSON.stringify(u),muteHttpExceptions:!0},d=yield fetch(s,m);if(![200,400,401,404,502].includes(d.status))return{detail:`Wrong response code: ${d.status}`};try{return yield d.json()}catch(e){return{detail:`Invalid JSON: ${e}`}}},new O(((e,t)=>{var a=e=>{try{r(s.next(e))}catch(e){t(e)}},n=e=>{try{r(s.throw(e))}catch(e){t(e)}},r=t=>t.done?e(t.value):O.resolve(t.value).then(a,n);r((s=s.apply(i,c)).next())}));var i,c,s}var _=a(64583).Promise,A=(e,t,a)=>new _(((n,r)=>{var l=e=>{try{i(a.next(e))}catch(e){r(e)}},o=e=>{try{i(a.throw(e))}catch(e){r(e)}},i=e=>e.done?n(e.value):_.resolve(e.value).then(l,o);i((a=a.apply(e,t)).next())}));var P=a(55707),j=a(64583).Promise,N=Object.defineProperty,C=Object.defineProperties,I=Object.getOwnPropertyDescriptors,R=Object.getOwnPropertySymbols,D=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,F=(e,t,a)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,T=(e,t)=>{for(var a in t||(t={}))D.call(t,a)&&F(e,a,t[a]);if(R)for(var a of R(t))B.call(t,a)&&F(e,a,t[a]);return e},k=(e,t)=>C(e,I(t)),z=(e,t,a)=>new j(((n,r)=>{var l=e=>{try{i(a.next(e))}catch(e){r(e)}},o=e=>{try{i(a.throw(e))}catch(e){r(e)}},i=e=>e.done?n(e.value):j.resolve(e.value).then(l,o);i((a=a.apply(e,t)).next())}));const K=(0,l.n)({root:{flexDirection:"column",display:"flex",paddingLeft:"10px",paddingRight:"10px"},answer_dialog:{flexDirection:"column",display:"flex"},dialog_field:{fontWeight:600,marginBottom:"15px"},button_send:{width:"100%",marginBottom:"10px"},spinner:{width:"75%"},pencil:{marginLeft:"2px",marginRight:"4px"}});var L=()=>{const e=K(),[t,a]=n.useState({show:!1,text:""}),[r,l]=n.useState(!1),[o,i]=n.useState({current:"",state:"none"}),c="Eingeben..";n.useEffect((()=>{z(void 0,null,(function*(){var e=localStorage.getItem("answer");e&&""!=e||(e=c),i({current:e,state:"none"})}))}),[]);return n.createElement("div",{className:e.root,role:"tabpanel","aria-labelledby":"Settings"},r&&n.createElement(s.l,{defaultOpen:!0},n.createElement(u.E,{className:e.spinner},n.createElement(m.y,{autoFocus:!0,labelPosition:"after",label:"Loading..."}))),t.show&&n.createElement(E,{type:"alert",title:"Fehler",content:t.text,closeName:"OK",showPrimary:!1,onResultDialog:()=>{l(!1),a(k(T({},t),{show:!1}))}}),n.createElement("div",{className:e.answer_dialog},n.createElement(d.D,{className:e.dialog_field,label:n.createElement(n.Fragment,null,n.createElement(P.A,{size:18,className:e.pencil})," Nutzer Input"),validationState:o.state,validationMessage:"Kurze Antwort eingeben",required:!0},n.createElement(p.T,{value:o.current,rows:10,placeholder:"Kurzen Text eingeben..",size:"large",resize:"vertical",onChange:e=>{i(k(T({},o),{current:e.target.value}))}})),n.createElement(f.$,{className:e.button_send,appearance:"primary",onClick:()=>{if((()=>{var e;let t=!0;var a=null!=(e=o.current)?e:"";return" "==a&&(a=c,localStorage.setItem("answer",a)),""==(a=a.trim())?(i({current:a,state:"error"}),t=!1):i({current:a,state:"none"}),t})()){localStorage.setItem("answer",o.current);var e=localStorage.getItem("apiKey");""!=e?function(e){A(this,null,(function*(){Office.context.mailbox.item.subject.getAsync((t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const a=t.value;Office.context.mailbox.item.from.getAsync((t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const n=t.value.emailAddress,r=n;Office.context.mailbox.item.to.getAsync((t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const l=t.value.map((e=>e.emailAddress));Office.context.mailbox.item.cc.getAsync((t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const o=t.value.map((e=>e.emailAddress));Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text,(t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const i=t.value;e({subject:a,sender:n,body:i,user_email:r,recipients:l,cc:o})}))}))}))}))}))}))}((t=>{l(!0);var n=o.current;S("/outlook/generate-email",e,t.subject,t.sender,t.body,n,t.user_email,t.recipients,t.cc).then((e=>z(void 0,null,(function*(){l(!1),"success"==e.status?function(e){A(this,null,(function*(){var t;try{null==(t=Office.context.mailbox.item)||t.body.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Text},(e=>{if(e.status===Office.AsyncResultStatus.Failed)throw e.error.message}))}catch(e){}}))}(e.email_text):a({show:!0,text:e.detail})})))).catch((e=>{l(!1),a({show:!0,text:`Request error: ${e}`})}))})):a({show:!0,text:"API-Schlüssel nicht angegeben"})}}},"Antwort generieren")))},$=a(14852),q=a(64583).Promise,W=Object.defineProperty,H=Object.defineProperties,J=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable,Q=(e,t,a)=>t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,U=(e,t)=>{for(var a in t||(t={}))V.call(t,a)&&Q(e,a,t[a]);if(M)for(var a of M(t))G.call(t,a)&&Q(e,a,t[a]);return e},X=(e,t)=>H(e,J(t));const Y=(0,l.n)({root:{flexDirection:"column",display:"flex",paddingLeft:"10px",paddingRight:"10px"},saving_dialog:{flexDirection:"column",display:"flex"},dialog_field:{fontWeight:600,marginBottom:"15px"},dialog_add:{width:"100%",marginBottom:"10px"}});var Z=()=>{const e=Y(),[t,a]=n.useState({show:!1,text:""}),[r,l]=n.useState({current:"",state:"none"});n.useEffect((()=>{var e,t,a;e=void 0,t=null,a=function*(){var e=localStorage.getItem("apiKey");l({current:e,state:"none"})},new q(((n,r)=>{var l=e=>{try{i(a.next(e))}catch(e){r(e)}},o=e=>{try{i(a.throw(e))}catch(e){r(e)}},i=e=>e.done?n(e.value):q.resolve(e.value).then(l,o);i((a=a.apply(e,t)).next())}))}),[]);return n.createElement("div",{className:e.root,role:"tabpanel","aria-labelledby":"Settings"},t.show&&n.createElement(E,{type:"modal",title:"Info",content:t.text,closeName:"OK",showPrimary:!1,onResultDialog:()=>{a(X(U({},t),{show:!1}))}}),n.createElement("div",{className:e.saving_dialog},n.createElement(d.D,{className:e.dialog_field,label:"API-Schlüsselwert",validationState:r.state,validationMessage:"Kopieren Sie Ihren API-Schlüsselwert und fügen Sie ihn ein",required:!0},n.createElement($.p,{value:r.current,placeholder:"z.b. outlookapi47eda17f38081e...",onChange:e=>{l(X(U({},r),{current:e.target.value}))}})),n.createElement(f.$,{className:e.dialog_add,appearance:"primary",onClick:()=>{var e;e=r.current.trim(),l(X(U({},r),{current:e,state:"none"})),localStorage.setItem("apiKey",r.current),a({show:!0,text:"Änderungen gespeichert"})}},"Speichern")))};const ee=(0,l.n)({root:{alignItems:"flex-start",display:"flex",flexDirection:"column",justifyContent:"flex-start",paddingTop:"10px",paddingLeft:"1px",paddingRight:"1px"},tab_menu:{paddingBottom:"20px"},tab_cont:{width:"100%"}}),te=()=>{const e=ee();var t=localStorage.getItem("apiKey");const[a,r]=n.useState(""==t?"settings":"answer");return n.createElement("div",{className:e.root},n.createElement(i.w,{className:e.tab_menu,selectedValue:a,onTabSelect:(e,t)=>{r(t.value)}},n.createElement(c.o,{id:"Answer",value:"answer"},"Antwort"),n.createElement(c.o,{id:"Settings",value:"settings"},"Einstellungen")),n.createElement("div",{className:e.tab_cont},"answer"===a&&n.createElement(L,null),"settings"===a&&n.createElement(Z,null)))};const ae=(0,l.n)({root:{minHeight:"100vh",maxWidth:"370px"},divider:{marginTop:"10px"}});var ne=()=>{const e=ae();return n.createElement("div",{className:e.root},n.createElement(te,null),n.createElement(o.c,{className:e.divider,inset:!0}))},re=a(37786),le=a(81722),oe=Object.defineProperty,ie=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable,ue=(e,t,a)=>t in e?oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;const me=((e,t)=>{for(var a in t||(t={}))ce.call(t,a)&&ue(e,a,t[a]);if(ie)for(var a of ie(t))se.call(t,a)&&ue(e,a,t[a]);return e})({},(0,re.a)({10:"#010101",20:"#010202",30:"#010403",40:"#0D1C17",50:"#0F2F25",60:"#0E3D30",70:"#094B3A",80:"#005B46",90:"#216753",100:"#377461",110:"#4B816F",120:"#5F8E7D",130:"#729B8C",140:"#85A99C",150:"#98B7AB",160:"#ACC4BB"})),de=document.getElementById("container"),pe=de?(0,r.H)(de):void 0;Office.onReady((()=>{null==pe||pe.render(n.createElement(le.q,{theme:me},n.createElement(ne,null)))}))},39046:function(){}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[96],(function(){return t(88078),t(39046)}));e.O()}]);
//# sourceMappingURL=taskpane.js.map