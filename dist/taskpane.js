"use strict";(self.webpackChunkoffice_addin_taskpane_react=self.webpackChunkoffice_addin_taskpane_react||[]).push([[926],{86863:function(e,t,n){var a=n(96540),r=n(5338),l=n(44541),i=n(29105),o=n(63171),s=n(52766),c=n(83128),d=n(96668),m=n(74324),u=n(86702),p=n(26117),g=n(25892),f=n(11439),h=n(40678),v=n(1419),y=n(86366),x=n(48352),b=n(10900),E=n(24938),w=n(27037),S=n(9265),A=n(27395),N=n(69563);const O=(0,l.n)({dialog:{marginTop:"10px",marginRight:"10px",marginLeft:"10px"},dialog_apply:{backgroundColor:"red"}});var C=e=>{const t=O();return a.createElement(g.l,{modalType:e.type,defaultOpen:!0,onOpenChange:()=>{e.onResultDialog("cancel")}},a.createElement(f.E,{className:t.dialog},a.createElement(E.R,null,a.createElement(w.L,null,e.title),a.createElement(S.C,null,(0,b.Ay)(e.content)),a.createElement(A.i,null,a.createElement(N.z,{disableButtonEnhancement:!0},a.createElement(x.$,{appearance:"secondary",autoFocus:!0},e.closeName)),e.showPrimary&&a.createElement(x.$,{appearance:"primary",className:t.dialog_apply,onClick:()=>{e.onResultDialog("ok")}},"Löschen")))))},k=n(64583).Promise;function T(e,t,n,a,r,l,i){return o=this,s=arguments,c=function*(e,t,n,a,r,l,i,o=[],s=[],c,d){var m="https://fg.server.lavel.io"+e;const u={"Content-Type":"application/json",authorization:t},p={messages:[{subject:n,body:r,sender:a,recipients:o,cc:s,thread_body:r,raw_content:null}],user_input:l,target_language:"german",user_email:i};d&&d.length>0&&d.some((e=>e.text))&&(p.documents=d),d&&d.length>0&&(p.documents=d.filter((e=>""!==e.text.trim())));var g={method:"POST",headers:u,body:JSON.stringify(p),muteHttpExceptions:!0},f=yield fetch(m,g);if(![200,400,401,404,502].includes(f.status))return{detail:`Wrong response code: ${f.status}`};try{return yield f.json()}catch(e){return{detail:`Invalid JSON: ${e}`}}},new k(((e,t)=>{var n=e=>{try{r(c.next(e))}catch(e){t(e)}},a=e=>{try{r(c.throw(e))}catch(e){t(e)}},r=t=>t.done?e(t.value):k.resolve(t.value).then(n,a);r((c=c.apply(o,s)).next())}));var o,s,c}var D=n(64583).Promise,B=(e,t,n)=>new D(((a,r)=>{var l=e=>{try{o(n.next(e))}catch(e){r(e)}},i=e=>{try{o(n.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):D.resolve(e.value).then(l,i);o((n=n.apply(e,t)).next())}));function _(e){return B(this,null,(function*(){Office.context.mailbox.item.subject.getAsync((t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const n=t.value;Office.context.mailbox.item.from.getAsync((t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const a=t.value.emailAddress,r=a;Office.context.mailbox.item.to.getAsync((t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const l=t.value.map((e=>e.emailAddress));Office.context.mailbox.item.cc.getAsync((t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const i=t.value.map((e=>e.emailAddress));Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text,(t=>{if(t.status===Office.AsyncResultStatus.Failed)return;const o=t.value;e({subject:n,sender:a,body:o,user_email:r,recipients:l,cc:i})}))}))}))}))}))}))}var I=n(79804),z=n(65892),j=n(94796),P=n(80827),R=n(35404),F=n(48697),$=n(64583).Promise,K=Object.defineProperty,L=Object.defineProperties,M=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,Z=(e,t,n)=>t in e?K(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,J=(e,t)=>{for(var n in t||(t={}))V.call(t,n)&&Z(e,n,t[n]);if(W)for(var n of W(t))H.call(t,n)&&Z(e,n,t[n]);return e},q=(e,t)=>L(e,M(t)),U=(e,t,n)=>new $(((a,r)=>{var l=e=>{try{o(n.next(e))}catch(e){r(e)}},i=e=>{try{o(n.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):$.resolve(e.value).then(l,i);o((n=n.apply(e,t)).next())}));const G="fg-chat-ocr",Q=(0,l.n)({root:{flexDirection:"column",display:"flex",paddingLeft:"10px",paddingRight:"10px"},answer_dialog:{flexDirection:"column",display:"flex"},dialog_field:{fontWeight:600,marginBottom:"15px"},button_send:{width:"100%",marginBottom:"10px"},spinner:{width:"75%"},customLoadingOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.8)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999},loadingText:{marginTop:"10px",fontSize:"14px",fontWeight:600},pencil:{marginLeft:"2px",marginRight:"4px"},dropZone:{border:"2px dashed #ccc",borderRadius:"4px",padding:"20px",textAlign:"center",marginBottom:"15px",cursor:"pointer",transition:"all 0.3s ease"},dropZoneActive:{border:"2px dashed #0078d4",backgroundColor:"rgba(0, 120, 212, 0.05)"},dropZoneSuccess:{border:"2px dashed #107c10",backgroundColor:"rgba(16, 124, 16, 0.05)"},filePreview:{display:"flex",alignItems:"center",padding:"8px 12px",backgroundColor:"#f3f2f1",borderRadius:"4px",marginBottom:"15px"},fileIcon:{marginRight:"8px",color:"#0078d4"},fileName:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},removeButton:{cursor:"pointer",color:"#605e5c","&:hover":{color:"#d13438"}},copyButton:{cursor:"pointer",color:"#605e5c",marginRight:"8px","&:hover":{color:"#0078d4"}},divider:{margin:"15px 0"},fileUploadInfo:{marginBottom:"10px",fontSize:"12px",color:"#605e5c"},ocrCompletedMessage:{color:"green",display:"block",marginTop:"5px"},checkIcon:{verticalAlign:"middle",marginRight:"5px"},hiddenInput:{display:"none"}});var X=()=>{const e=Q(),[t,n]=a.useState({show:!1,text:""}),[r,l]=a.useState(!1),[o,s]=a.useState(!1),[b,E]=a.useState({current:"",state:"none"}),[w,S]=a.useState({}),[A,N]=a.useState(""),[O,k]=a.useState(!1),[D,$]=a.useState([]),[K,L]=a.useState(!1),[M,W]=a.useState(!1),[V,H]=a.useState(!1),[Z,X]=a.useState([]),Y=a.useRef(null),{dispatchToast:ee}=(0,c.J)(),te="Eingeben..";a.useEffect((()=>{U(void 0,null,(function*(){var e=localStorage.getItem("answer");e&&""!=e||(e=te),E({current:e,state:"none"}),N(""),S({}),$([]),H(!1),X([])}))}),[]);const ne=(e,t)=>{const n=e.map((e=>t[e.name]||"")).filter((e=>""!==e.trim())).join("\n\n");N(n)},ae=e=>U(void 0,null,(function*(){try{const t=localStorage.getItem("apiKey")||"";if(""===t)return n({show:!0,text:"API-Schlüssel nicht angegeben"}),void W(!1);const r=e.map((e=>({filename:e,bucket:G}))),l=yield fetch("https://fg.server.lavel.io/outlook/ocr-detect",{method:"POST",headers:{"Content-Type":"application/json",Authorization:t},body:JSON.stringify({files:r})}),i=yield l.json();if(!l.ok)throw new Error(i.detail||"OCR processing failed");if(i.documents&&i.documents.length>0){const t=J({},w);i.documents.forEach(((n,a)=>{var r;if(a<e.length&&n.text){const e=(null==(r=D[a])?void 0:r.name)||`Document ${a+1}`;t[e]=n.text}})),S(t);const n=D.map((e=>t[e.name]||"")).filter((e=>""!==e.trim())).join("\n\n");N(n)}W(!1),H(!0),ee(a.createElement(d.y,null,a.createElement(m.S,{media:a.createElement(I.A,{color:"green"})},"OCR erfolgreich abgeschlossen")),{position:"top",timeout:5e3})}catch(e){n({show:!0,text:`OCR-Fehler: ${e.message}`}),W(!1)}}));a.useEffect((()=>{D.length>0&&!K&&!M&&!V&&U(void 0,null,(function*(){if(0!==D.length){L(!0),W(!0);try{const e=[],t=[],n=[];for(const a of D){const r=yield fetch("https://fg.server.lavel.io/generate_presigned_upload_url",{method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("apiKey")||""},body:JSON.stringify({filename:a.name,content_type:a.type,bucket_name:G})});if(!r.ok)throw new Error(`Failed to get presigned URL: ${r.statusText}`);const l=yield r.json(),i=yield fetch(l.url,{method:"PUT",headers:{"Content-Type":a.type},body:a});if(!i.ok)throw new Error(`Failed to upload ${a.name}: ${i.statusText}`);e.push(l.filename),t.push(l.uuid),n.push(l.filetype)}X(e),L(!1),yield ae(t.map(((e,t)=>`${e}${n[t]}`)))}catch(e){n({show:!0,text:`Fehler beim Hochladen: ${e.message}`}),L(!1),W(!1)}}}))}),[D,K,M,V]);return a.createElement("div",{className:e.root,role:"tabpanel","aria-labelledby":"Settings"},a.createElement(u.l,null),o&&a.createElement("div",{className:e.customLoadingOverlay},a.createElement(p.y,{size:"large"}),a.createElement("div",{className:e.loadingText},"Antwort wird generiert...")),(r||K||M)&&a.createElement(g.l,{defaultOpen:!0},a.createElement(f.E,{className:e.spinner},a.createElement(p.y,{autoFocus:!0,labelPosition:"after",label:K?"Dateien werden hochgeladen...":M?"OCR-Verarbeitung läuft...":"Wird geladen..."}))),t.show&&a.createElement(C,{type:"alert",title:"Fehler",content:t.text,closeName:"OK",showPrimary:!1,onResultDialog:()=>{l(!1),n(q(J({},t),{show:!1}))}}),a.createElement("div",{className:e.answer_dialog},a.createElement(h.D,{className:e.dialog_field,label:a.createElement(a.Fragment,null,a.createElement(z.A,{size:18,className:e.pencil})," Nutzer Input"),validationState:b.state,validationMessage:"Kurze Antwort eingeben",required:!0},a.createElement(v.T,{value:b.current,rows:10,placeholder:"Kurzen Text eingeben..",size:"large",resize:"vertical",onChange:e=>{const t=e.target.value;E(q(J({},b),{current:t})),N(t)},lang:"de"})),a.createElement(i.c,{className:e.divider}),a.createElement(y.E,{className:e.fileUploadInfo},"Laden Sie bis zu 5 PDF-Dateien hoch, um Text zu extrahieren und in die Anfrage einzubeziehen"),a.createElement("div",{ref:Y,className:`${e.dropZone} ${O?e.dropZoneActive:""} ${V?e.dropZoneSuccess:""}`,onDragOver:e=>{e.preventDefault(),k(!0)},onDragLeave:e=>{e.preventDefault(),k(!1)},onDrop:e=>{if(e.preventDefault(),k(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0){const t=Array.from(e.dataTransfer.files),a=t.filter((e=>"application/pdf"===e.type)),r=t.length-a.length;if(r>0&&n({show:!0,text:`${r} Datei(en) wurden ignoriert. Nur PDF-Dateien werden unterstützt.`}),a.length>0){const e=[...D,...a].slice(0,5);$(e),H(!1),D.length+a.length>5&&n({show:!0,text:"Maximal 5 Dateien können hochgeladen werden."})}}},onClick:()=>{const e=document.getElementById("file-input");e&&e.click()}},a.createElement(j.A,{size:24}),a.createElement("p",null,"PDF-Dateien hierher ziehen oder klicken zum Auswählen (",D.length,"/5)",V&&D.length>0&&a.createElement("span",{className:e.ocrCompletedMessage},a.createElement(I.A,{size:16,className:e.checkIcon}),"OCR abgeschlossen")),a.createElement("input",{id:"file-input",type:"file",accept:"application/pdf",className:e.hiddenInput,multiple:!0,onChange:e=>{if(e.target.files&&e.target.files.length>0){const t=Array.from(e.target.files),a=t.filter((e=>"application/pdf"===e.type)),r=t.length-a.length;if(r>0&&n({show:!0,text:`${r} Datei(en) wurden ignoriert. Nur PDF-Dateien werden unterstützt.`}),a.length>0){const e=[...D,...a].slice(0,5);$(e),H(!1),D.length+a.length>5&&n({show:!0,text:"Maximal 5 Dateien können hochgeladen werden."})}}},"aria-label":"PDF-Datei auswählen"})),D.length>0&&a.createElement("div",{style:{marginBottom:"15px"}},D.map(((t,r)=>a.createElement("div",{key:r,className:e.filePreview},a.createElement(P.A,{size:20,className:e.fileIcon}),a.createElement("span",{className:e.fileName},t.name),a.createElement(R.A,{size:18,className:e.copyButton,onClick:()=>(e=>{const t=D[e],r=t?t.name:"",l=r&&w[r]?w[r]:"";if(s(!1),l&&""!==l.trim())try{const e=document.createElement("textarea");e.value=l,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),ee(a.createElement(d.y,null,a.createElement(m.S,{media:a.createElement(I.A,{color:"green"})},"Text in die Zwischenablage kopiert")),{position:"top",timeout:3e3})}catch(e){n({show:!0,text:`Fehler beim Kopieren des Textes: ${e.message}`})}else n({show:!0,text:"Kein OCR-Text für dieses Dokument verfügbar"})})(r),"aria-label":"Copy OCR text"}),a.createElement(F.A,{size:18,className:e.removeButton,onClick:()=>(e=>{const t=D[e],n=[...D];if(n.splice(e,1),$(n),t){const e=J({},w);delete e[t.name],S(e),ne(n,e)}0===n.length&&(H(!1),X([]),N(""),S({}))})(r),"aria-label":"Remove file"}))))),a.createElement(x.$,{className:e.button_send,appearance:"primary",onClick:()=>{if((()=>{var e;let t=!0;var n=null!=(e=b.current)?e:"";return" "==n&&(n=te,localStorage.setItem("answer",n)),""==(n=n.trim())?(E({current:n,state:"error"}),t=!1):E({current:n,state:"none"}),t})()){s(!1),localStorage.setItem("answer",b.current),N(b.current);var e=localStorage.getItem("apiKey");""!=e?D.length>0&&!V?n({show:!0,text:"Bitte warten Sie, bis die OCR-Verarbeitung der PDF-Dateien abgeschlossen ist, bevor Sie eine Antwort generieren."}):_((t=>{l(!0),s(!0);var a=b.current;let r;const i=[];if(D.length>0)for(const e of D)w[e.name]&&""!==w[e.name].trim()&&i.push({filename:e.name,text:w[e.name]});T("/outlook/generate-email",e,t.subject,t.sender,t.body,a,t.user_email,t.recipients,t.cc,r,i).then((e=>U(void 0,null,(function*(){l(!1),s(!1),"success"==e.status?function(e){B(this,null,(function*(){var t;try{null==(t=Office.context.mailbox.item)||t.body.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Text},(e=>{if(e.status===Office.AsyncResultStatus.Failed)throw e.error.message}))}catch(e){}}))}(e.email_text):n({show:!0,text:e.detail})})))).catch((e=>{l(!1),s(!1),n({show:!0,text:`Anfragefehler: ${e}`})}))})):n({show:!0,text:"API-Schlüssel nicht angegeben"})}}},"Antwort generieren")))},Y=n(14852),ee=n(64583).Promise,te=Object.defineProperty,ne=Object.defineProperties,ae=Object.getOwnPropertyDescriptors,re=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable,oe=(e,t,n)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,se=(e,t)=>{for(var n in t||(t={}))le.call(t,n)&&oe(e,n,t[n]);if(re)for(var n of re(t))ie.call(t,n)&&oe(e,n,t[n]);return e},ce=(e,t)=>ne(e,ae(t));const de=(0,l.n)({root:{flexDirection:"column",display:"flex",paddingLeft:"10px",paddingRight:"10px"},saving_dialog:{flexDirection:"column",display:"flex"},dialog_field:{fontWeight:600,marginBottom:"15px"},dialog_add:{width:"100%",marginBottom:"10px"}});var me=()=>{const e=de(),[t,n]=a.useState({show:!1,text:""}),[r,l]=a.useState({current:"",state:"none"});a.useEffect((()=>{var e,t,n;e=void 0,t=null,n=function*(){var e=localStorage.getItem("apiKey");l({current:e,state:"none"})},new ee(((a,r)=>{var l=e=>{try{o(n.next(e))}catch(e){r(e)}},i=e=>{try{o(n.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):ee.resolve(e.value).then(l,i);o((n=n.apply(e,t)).next())}))}),[]);return a.createElement("div",{className:e.root,role:"tabpanel","aria-labelledby":"Settings"},t.show&&a.createElement(C,{type:"modal",title:"Info",content:t.text,closeName:"OK",showPrimary:!1,onResultDialog:()=>{n(ce(se({},t),{show:!1}))}}),a.createElement("div",{className:e.saving_dialog},a.createElement(h.D,{className:e.dialog_field,label:"API-Schlüsselwert",validationState:r.state,validationMessage:"Kopieren Sie Ihren API-Schlüsselwert und fügen Sie ihn ein",required:!0},a.createElement(Y.p,{value:r.current,placeholder:"z.b. outlookapi47eda17f38081e...",onChange:e=>{l(ce(se({},r),{current:e.target.value}))}})),a.createElement(x.$,{className:e.dialog_add,appearance:"primary",onClick:()=>{var e;e=r.current.trim(),l(ce(se({},r),{current:e,state:"none"})),localStorage.setItem("apiKey",r.current),n({show:!0,text:"Änderungen gespeichert"})}},"Speichern")))},ue=n(61714),pe=n(75399),ge=n(37012),fe=n(33879),he=n(48635);const ve=(0,l.n)({root:{flexDirection:"column",display:"flex",paddingLeft:"10px",paddingRight:"10px"},formContainer:{display:"flex",flexDirection:"column",gap:"15px"},button:{width:"100%",marginBottom:"10px"},spinner:{width:"75%"},customLoadingOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.8)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999},loadingText:{marginTop:"10px",fontSize:"14px",fontWeight:600},divider:{margin:"15px 0"},stepContainer:{marginBottom:"20px"},stepHeader:{display:"flex",alignItems:"center",marginBottom:"10px"},stepNumber:{display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#0078d4",color:"white",marginRight:"10px",fontSize:"14px",fontWeight:"bold"},stepTitle:{fontWeight:"bold",fontSize:"16px"},suggestionCard:{marginBottom:"15px",border:"1px solid #edebe9",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},cardHeader:{paddingBottom:"8px"},cardContent:{padding:"0 16px 16px 16px"},fieldGroup:{marginBottom:"12px"},fieldLabel:{fontWeight:"600",marginBottom:"4px",fontSize:"12px",color:"#605e5c"},fieldValue:{fontSize:"14px",padding:"8px",backgroundColor:"#f3f2f1",borderRadius:"4px"},nextStepButton:{marginTop:"10px"},assignedUserField:{marginTop:"15px"}});var ye=()=>{const e=ve(),{dispatchToast:t}=(0,c.J)(),[n,r]=a.useState({show:!1,text:""}),[l,o]=a.useState(!1),[s,v]=a.useState(!1),[b,E]=a.useState(1),[w,S]=a.useState(""),[A,N]=a.useState(""),[O,k]=a.useState(""),[T,D]=a.useState([]),[B,z]=a.useState(""),[j,P]=a.useState(""),[R,F]=a.useState(""),[$,K]=a.useState("");a.useEffect((()=>{(()=>{try{o(!0),_((e=>{if(!e)return r({show:!0,text:"Keine E-Mail ausgewählt. Bitte wählen Sie eine E-Mail aus, um fortzufahren."}),void o(!1);const t=localStorage.getItem("apiKey");if(!t)return r({show:!0,text:"Kein API-Schlüssel gefunden. Bitte geben Sie einen API-Schlüssel in den Einstellungen ein."}),void o(!1);const n={messages:[{subject:e.subject||"",body:e.body||"",sender:e.sender||"",recipients:e.recipients||[],cc:e.cc||[],thread_body:e.body||"",raw_content:null}]};fetch("https://fg.server.lavel.io/outlook/combined-activity-data",{method:"POST",headers:{"Content-Type":"application/json",Authorization:t},body:JSON.stringify(n)}).then((e=>e.ok?e.json():e.json().then((e=>{throw new Error(e.detail||"Fehler beim Abrufen der Aktivitätsdaten")})))).then((t=>{S(t.suggested_title||""),N(t.category||""),k(t.folder_id||""),D(t.categories||[]),z(t.suggested_title||""),P(t.category||""),K(t.folder_id?`${t.folder_id}`:"");const n=localStorage.getItem("userEmail")||e.user_email||"";F(n),o(!1)})).catch((e=>{r({show:!0,text:`Fehler beim Abrufen der Vorschläge: ${e.message}`}),o(!1)}))}))}catch(e){r({show:!0,text:`Fehler: ${e.message}`}),o(!1)}})()}),[]);return a.createElement("div",{className:e.root},l&&a.createElement("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px"}},a.createElement(p.y,{className:e.spinner,label:"Lade Vorschläge..."})),s&&a.createElement("div",{className:e.customLoadingOverlay},a.createElement(p.y,{size:"large"}),a.createElement("div",{className:e.loadingText},"Aktivität wird erstellt...")),!l&&a.createElement("div",{className:e.formContainer},1===b&&a.createElement("div",{className:e.stepContainer},a.createElement("div",{className:e.stepHeader},a.createElement("div",{className:e.stepNumber},"1"),a.createElement("div",{className:e.stepTitle},"Aktivitätsvorschlag prüfen")),a.createElement(y.E,null,'Basierend auf der ausgewählten E-Mail wurde ein Aktivitätsvorschlag erstellt. Überprüfen Sie die Informationen und klicken Sie auf "Weiter", um fortzufahren.'),a.createElement(i.c,{className:e.divider}),a.createElement(ue.Z,{className:e.suggestionCard},a.createElement(pe.a,{className:e.cardHeader,header:a.createElement(y.E,{weight:"semibold"},"Vorgeschlagene Aktivität")}),a.createElement("div",{className:e.cardContent},a.createElement("div",{className:e.fieldGroup},a.createElement("div",{className:e.fieldLabel},"Titel"),a.createElement("div",{className:e.fieldValue},w)),a.createElement("div",{className:e.fieldGroup},a.createElement("div",{className:e.fieldLabel},"Kategorie"),a.createElement("div",{className:e.fieldValue},A)),a.createElement("div",{className:e.fieldGroup},a.createElement("div",{className:e.fieldLabel},"Ordner ID"),a.createElement("div",{className:e.fieldValue},O)))),a.createElement(x.$,{appearance:"primary",className:e.nextStepButton,onClick:()=>{E(2)},icon:a.createElement(he.A,null)},"Weiter zur Bearbeitung")),2===b&&a.createElement("div",{className:e.stepContainer},a.createElement("div",{className:e.stepHeader},a.createElement("div",{className:e.stepNumber},"2"),a.createElement("div",{className:e.stepTitle},"Aktivität bearbeiten und erstellen")),a.createElement(y.E,null,'Bearbeiten Sie die Aktivitätsinformationen nach Bedarf und klicken Sie auf "Aktivität erstellen", um die Aktivität zu erstellen.'),a.createElement(i.c,{className:e.divider}),a.createElement(h.D,{label:"Titel",required:!0},a.createElement(Y.p,{value:B,onChange:e=>z(e.target.value),placeholder:"Aktivitätstitel"})),a.createElement(h.D,{label:"Kategorie",required:!0},a.createElement(ge.m,{value:j,onOptionSelect:(e,t)=>P(t.optionValue||""),placeholder:"Kategorie auswählen"},T.map((e=>a.createElement(fe.c,{key:e,value:e},e))))),a.createElement(h.D,{label:"Ordnerpfad",required:!0},a.createElement(Y.p,{value:$,onChange:e=>K(e.target.value),placeholder:"z.B. 301 Projektname"})),a.createElement(h.D,{label:"Zugewiesener Benutzer",required:!0,className:e.assignedUserField},a.createElement(Y.p,{value:R,onChange:e=>F(e.target.value),placeholder:"E-Mail-Adresse"})),a.createElement(i.c,{className:e.divider}),a.createElement("div",{style:{display:"flex",gap:"10px"}},a.createElement(x.$,{appearance:"secondary",onClick:()=>{E(1)}},"Zurück"),a.createElement(x.$,{appearance:"primary",onClick:()=>{try{v(!0),_((e=>{if(!e)return r({show:!0,text:"Keine E-Mail ausgewählt. Bitte wählen Sie eine E-Mail aus, um fortzufahren."}),void v(!1);const n=localStorage.getItem("apiKey");if(!n)return r({show:!0,text:"Kein API-Schlüssel gefunden. Bitte geben Sie einen API-Schlüssel in den Einstellungen ein."}),void v(!1);if(!B.trim())return r({show:!0,text:"Bitte geben Sie einen Titel ein."}),void v(!1);if(!j.trim())return r({show:!0,text:"Bitte wählen Sie eine Kategorie aus."}),void v(!1);if(!R.trim())return r({show:!0,text:"Bitte geben Sie einen zugewiesenen Benutzer ein."}),void v(!1);if(!$.trim())return r({show:!0,text:"Bitte geben Sie einen Ordnerpfad ein."}),void v(!1);const l={title:B,category:j,assigned_user:R,messages:[{subject:e.subject||"",body:e.body||"",sender:e.sender||"",recipients:e.recipients||[],cc:e.cc||[],thread_body:e.body||""}],folder_path:$,shouldCreateActivity:!0};fetch("https://fg.server.lavel.io/outlook/create-activity",{method:"POST",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify(l)}).then((e=>e.ok?e.json():e.json().then((e=>{throw new Error(e.detail||"Fehler beim Erstellen der Aktivität")})))).then((e=>{t(a.createElement(d.y,null,a.createElement(m.S,{media:a.createElement(I.A,{color:"green"})},"Aktivität erfolgreich erstellt")),{position:"top",timeout:3e3}),E(1),S(""),N(""),k(""),z(""),P(""),F(""),K(""),v(!1)})).catch((e=>{r({show:!0,text:`Fehler beim Erstellen der Aktivität: ${e.message}`}),v(!1)}))}))}catch(e){r({show:!0,text:`Fehler: ${e.message}`}),v(!1)}}},"Aktivität erstellen")))),n.show&&a.createElement(g.l,{modalType:"alert",open:n.show},a.createElement(f.E,null,a.createElement(C,{title:"Hinweis",message:n.text,onClose:()=>r({show:!1,text:""})}))),a.createElement(u.l,null))};const xe=(0,l.n)({root:{alignItems:"flex-start",display:"flex",flexDirection:"column",justifyContent:"flex-start",paddingTop:"10px",paddingLeft:"1px",paddingRight:"1px"},tab_menu:{paddingBottom:"20px"},tab_cont:{width:"100%"}}),be=()=>{const e=xe();var t=localStorage.getItem("apiKey");const[n,r]=a.useState(""==t?"settings":"answer");return a.createElement("div",{className:e.root},a.createElement(o.w,{className:e.tab_menu,selectedValue:n,onTabSelect:(e,t)=>{r(t.value)}},a.createElement(s.o,{id:"Answer",value:"answer"},"Antwort"),a.createElement(s.o,{id:"Activity",value:"activity"},"Aktivität"),a.createElement(s.o,{id:"Settings",value:"settings"},"Einstellungen")),a.createElement("div",{className:e.tab_cont},"answer"===n&&a.createElement(X,null),"activity"===n&&a.createElement(ye,null),"settings"===n&&a.createElement(me,null)))};const Ee=(0,l.n)({root:{minHeight:"100vh",maxWidth:"370px"},divider:{marginTop:"10px"}});var we=()=>{const e=Ee();return a.createElement("div",{className:e.root},a.createElement(be,null),a.createElement(i.c,{className:e.divider,inset:!0}))},Se=n(37786),Ae=n(81722),Ne=Object.defineProperty,Oe=Object.getOwnPropertySymbols,Ce=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable,Te=(e,t,n)=>t in e?Ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const De=((e,t)=>{for(var n in t||(t={}))Ce.call(t,n)&&Te(e,n,t[n]);if(Oe)for(var n of Oe(t))ke.call(t,n)&&Te(e,n,t[n]);return e})({},(0,Se.a)({10:"#010101",20:"#010202",30:"#010403",40:"#0D1C17",50:"#0F2F25",60:"#0E3D30",70:"#094B3A",80:"#005B46",90:"#216753",100:"#377461",110:"#4B816F",120:"#5F8E7D",130:"#729B8C",140:"#85A99C",150:"#98B7AB",160:"#ACC4BB"})),Be=document.getElementById("container"),_e=Be?(0,r.H)(Be):void 0;Office.onReady((()=>{null==_e||_e.render(a.createElement(Ae.q,{theme:De},a.createElement(we,null)))}))},39046:function(){}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[96],(function(){return t(86863),t(39046)}));e.O()}]);
//# sourceMappingURL=taskpane.js.map